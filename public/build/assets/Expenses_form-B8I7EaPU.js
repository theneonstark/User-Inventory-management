import{r as s,j as e,a as Se}from"./app-BQcaIY-e.js";import{F as Pt,C as At,a as kt,u as Dt,b as Ot}from"./index.esm-ZbofvOE3.js";import{L as Mt,y as se}from"./index-5-_raj7P.js";import{a as ze,P as M,d as xe,b as I,S as nt,u as st,B as U,I as Re}from"./input-C3cybE54.js";import{d as _t,C as Be}from"./calendar-Fph4I4kf.js";import{u as q,R as $t,P as Tt,O as Lt,C as Vt,a as Kt,c as zt,b as pe,d as at,e as Ut,h as qt,f as Ht,g as Yt,F as Gt,D as Bt}from"./index-Cv23YCoD.js";import"./dialog-_kpngBO7.js";import{S as Wt}from"./search-CKATGfp3.js";import{L as Jt}from"./label-g6V-RGNT.js";import{c as ot,R as Xt,A as lt,C as Zt,a as Qt,b as We}from"./index-DX14B-De.js";import{C as ae,a as oe,d as le,e as Fe,b as ie}from"./card-CntAeJCd.js";import{o as er}from"./orders-CfAbe6B9.js";import{r as it,t as fe,f as de}from"./index-C4oF5NQb.js";import{p as Je}from"./index-f-02PV4C.js";import{C as Xe}from"./calendar-Bd2c6gjH.js";import{L as tr}from"./Layout-DH3S-P2D.js";import"./index-BO0joN0c.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Ze=ze("ChevronsUpDown",rr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ie=ze("LoaderCircle",nr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ar=ze("Plus",sr);function Qe(t,n){var r=t.getFullYear()-n.getFullYear()||t.getMonth()-n.getMonth()||t.getDate()-n.getDate()||t.getHours()-n.getHours()||t.getMinutes()-n.getMinutes()||t.getSeconds()-n.getSeconds()||t.getMilliseconds()-n.getMilliseconds();return r<0?-1:r>0?1:r}function or(t,n){it(2,arguments);var r=fe(t),l=fe(n),a=Qe(r,l),i=Math.abs(_t(r,l));r.setDate(r.getDate()-a*i);var c=+(Qe(r,l)===-a),u=a*(i-c);return u===0?0:u}function lr(t,n){it(2,arguments);var r=fe(t).getTime(),l=fe(n.start).getTime(),a=fe(n.end).getTime();if(!(l<=a))throw new RangeError("Invalid interval");return r>=l&&r<=a}var et=1,ir=.9,dr=.8,cr=.17,Pe=.1,Ae=.999,ur=.9999,mr=.99,pr=/[\\\/_+.#"@\[\(\{&]/,fr=/[\\\/_+.#"@\[\(\{&]/g,xr=/[\s-]/,dt=/[\s-]/g;function Oe(t,n,r,l,a,i,c){if(i===n.length)return a===t.length?et:mr;var u=`${a},${i}`;if(c[u]!==void 0)return c[u];for(var v=l.charAt(i),m=r.indexOf(v,a),g=0,j,b,E,S;m>=0;)j=Oe(t,n,r,l,m+1,i+1,c),j>g&&(m===a?j*=et:pr.test(t.charAt(m-1))?(j*=dr,E=t.slice(a,m-1).match(fr),E&&a>0&&(j*=Math.pow(Ae,E.length))):xr.test(t.charAt(m-1))?(j*=ir,S=t.slice(a,m-1).match(dt),S&&a>0&&(j*=Math.pow(Ae,S.length))):(j*=cr,a>0&&(j*=Math.pow(Ae,m-a))),t.charAt(m)!==n.charAt(i)&&(j*=ur)),(j<Pe&&r.charAt(m-1)===l.charAt(i+1)||l.charAt(i+1)===l.charAt(i)&&r.charAt(m-1)!==l.charAt(i))&&(b=Oe(t,n,r,l,m+1,i+2,c),b*Pe>j&&(j=b*Pe)),j>g&&(g=j),m=r.indexOf(v,m+1);return c[u]=g,g}function tt(t){return t.toLowerCase().replace(dt," ")}function hr(t,n,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,Oe(t,n,tt(t),tt(n),0,0,{})}var ce='[cmdk-group=""]',ke='[cmdk-group-items=""]',vr='[cmdk-group-heading=""]',ct='[cmdk-item=""]',rt=`${ct}:not([aria-disabled="true"])`,Me="cmdk-item-select",B="data-value",gr=(t,n,r)=>hr(t,n,r),ut=s.createContext(void 0),he=()=>s.useContext(ut),mt=s.createContext(void 0),Ue=()=>s.useContext(mt),pt=s.createContext(void 0),ft=s.forwardRef((t,n)=>{let r=W(()=>{var o,f;return{search:"",value:(f=(o=t.value)!=null?o:t.defaultValue)!=null?f:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),l=W(()=>new Set),a=W(()=>new Map),i=W(()=>new Map),c=W(()=>new Set),u=xt(t),{label:v,children:m,value:g,onValueChange:j,filter:b,shouldFilter:E,loop:S,disablePointerSelection:Y=!1,vimBindings:_=!0,...K}=t,F=q(),ge=q(),te=q(),$=s.useRef(null),C=Ir();H(()=>{if(g!==void 0){let o=g.trim();r.current.value=o,P.emit()}},[g]),H(()=>{C(6,x)},[]);let P=s.useMemo(()=>({subscribe:o=>(c.current.add(o),()=>c.current.delete(o)),snapshot:()=>r.current,setState:(o,f,y)=>{var p,N,w,O;if(!Object.is(r.current[o],f)){if(r.current[o]=f,o==="search")h(),G(),C(1,d);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let A=document.getElementById(te);A?A.focus():(p=document.getElementById(F))==null||p.focus()}if(C(7,()=>{var A;r.current.selectedItemId=(A=R())==null?void 0:A.id,P.emit()}),y||C(5,x),((N=u.current)==null?void 0:N.value)!==void 0){let A=f??"";(O=(w=u.current).onValueChange)==null||O.call(w,A);return}}P.emit()}},emit:()=>{c.current.forEach(o=>o())}}),[]),re=s.useMemo(()=>({value:(o,f,y)=>{var p;f!==((p=i.current.get(o))==null?void 0:p.value)&&(i.current.set(o,{value:f,keywords:y}),r.current.filtered.items.set(o,je(f,y)),C(2,()=>{G(),P.emit()}))},item:(o,f)=>(l.current.add(o),f&&(a.current.has(f)?a.current.get(f).add(o):a.current.set(f,new Set([o]))),C(3,()=>{h(),G(),r.current.value||d(),P.emit()}),()=>{i.current.delete(o),l.current.delete(o),r.current.filtered.items.delete(o);let y=R();C(4,()=>{h(),(y==null?void 0:y.getAttribute("id"))===o&&d(),P.emit()})}),group:o=>(a.current.has(o)||a.current.set(o,new Set),()=>{i.current.delete(o),a.current.delete(o)}),filter:()=>u.current.shouldFilter,label:v||t["aria-label"],getDisablePointerSelection:()=>u.current.disablePointerSelection,listId:F,inputId:te,labelId:ge,listInnerRef:$}),[]);function je(o,f){var y,p;let N=(p=(y=u.current)==null?void 0:y.filter)!=null?p:gr;return o?N(o,r.current.search,f):0}function G(){if(!r.current.search||u.current.shouldFilter===!1)return;let o=r.current.filtered.items,f=[];r.current.filtered.groups.forEach(p=>{let N=a.current.get(p),w=0;N.forEach(O=>{let A=o.get(O);w=Math.max(A,w)}),f.push([p,w])});let y=$.current;k().sort((p,N)=>{var w,O;let A=p.getAttribute("id"),be=N.getAttribute("id");return((w=o.get(be))!=null?w:0)-((O=o.get(A))!=null?O:0)}).forEach(p=>{let N=p.closest(ke);N?N.appendChild(p.parentElement===N?p:p.closest(`${ke} > *`)):y.appendChild(p.parentElement===y?p:p.closest(`${ke} > *`))}),f.sort((p,N)=>N[1]-p[1]).forEach(p=>{var N;let w=(N=$.current)==null?void 0:N.querySelector(`${ce}[${B}="${encodeURIComponent(p[0])}"]`);w==null||w.parentElement.appendChild(w)})}function d(){let o=k().find(y=>y.getAttribute("aria-disabled")!=="true"),f=o==null?void 0:o.getAttribute(B);P.setState("value",f||void 0)}function h(){var o,f,y,p;if(!r.current.search||u.current.shouldFilter===!1){r.current.filtered.count=l.current.size;return}r.current.filtered.groups=new Set;let N=0;for(let w of l.current){let O=(f=(o=i.current.get(w))==null?void 0:o.value)!=null?f:"",A=(p=(y=i.current.get(w))==null?void 0:y.keywords)!=null?p:[],be=je(O,A);r.current.filtered.items.set(w,be),be>0&&N++}for(let[w,O]of a.current)for(let A of O)if(r.current.filtered.items.get(A)>0){r.current.filtered.groups.add(w);break}r.current.filtered.count=N}function x(){var o,f,y;let p=R();p&&(((o=p.parentElement)==null?void 0:o.firstChild)===p&&((y=(f=p.closest(ce))==null?void 0:f.querySelector(vr))==null||y.scrollIntoView({block:"nearest"})),p.scrollIntoView({block:"nearest"}))}function R(){var o;return(o=$.current)==null?void 0:o.querySelector(`${ct}[aria-selected="true"]`)}function k(){var o;return Array.from(((o=$.current)==null?void 0:o.querySelectorAll(rt))||[])}function ne(o){let f=k()[o];f&&P.setState("value",f.getAttribute(B))}function z(o){var f;let y=R(),p=k(),N=p.findIndex(O=>O===y),w=p[N+o];(f=u.current)!=null&&f.loop&&(w=N+o<0?p[p.length-1]:N+o===p.length?p[0]:p[N+o]),w&&P.setState("value",w.getAttribute(B))}function T(o){let f=R(),y=f==null?void 0:f.closest(ce),p;for(;y&&!p;)y=o>0?Rr(y,ce):Fr(y,ce),p=y==null?void 0:y.querySelector(rt);p?P.setState("value",p.getAttribute(B)):z(o)}let ye=()=>ne(k().length-1),Ye=o=>{o.preventDefault(),o.metaKey?ye():o.altKey?T(1):z(1)},Ge=o=>{o.preventDefault(),o.metaKey?ne(0):o.altKey?T(-1):z(-1)};return s.createElement(M.div,{ref:n,tabIndex:-1,...K,"cmdk-root":"",onKeyDown:o=>{var f;(f=K.onKeyDown)==null||f.call(K,o);let y=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||y))switch(o.key){case"n":case"j":{_&&o.ctrlKey&&Ye(o);break}case"ArrowDown":{Ye(o);break}case"p":case"k":{_&&o.ctrlKey&&Ge(o);break}case"ArrowUp":{Ge(o);break}case"Home":{o.preventDefault(),ne(0);break}case"End":{o.preventDefault(),ye();break}case"Enter":{o.preventDefault();let p=R();if(p){let N=new Event(Me);p.dispatchEvent(N)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:re.inputId,id:re.labelId,style:Ar},v),Ce(t,o=>s.createElement(mt.Provider,{value:P},s.createElement(ut.Provider,{value:re},o))))}),jr=s.forwardRef((t,n)=>{var r,l;let a=q(),i=s.useRef(null),c=s.useContext(pt),u=he(),v=xt(t),m=(l=(r=v.current)==null?void 0:r.forceMount)!=null?l:c==null?void 0:c.forceMount;H(()=>{if(!m)return u.item(a,c==null?void 0:c.id)},[m]);let g=ht(a,i,[t.value,t.children,i],t.keywords),j=Ue(),b=L(C=>C.value&&C.value===g.current),E=L(C=>m||u.filter()===!1?!0:C.search?C.filtered.items.get(a)>0:!0);s.useEffect(()=>{let C=i.current;if(!(!C||t.disabled))return C.addEventListener(Me,S),()=>C.removeEventListener(Me,S)},[E,t.onSelect,t.disabled]);function S(){var C,P;Y(),(P=(C=v.current).onSelect)==null||P.call(C,g.current)}function Y(){j.setState("value",g.current,!0)}if(!E)return null;let{disabled:_,value:K,onSelect:F,forceMount:ge,keywords:te,...$}=t;return s.createElement(M.div,{ref:xe(i,n),...$,id:a,"cmdk-item":"",role:"option","aria-disabled":!!_,"aria-selected":!!b,"data-disabled":!!_,"data-selected":!!b,onPointerMove:_||u.getDisablePointerSelection()?void 0:Y,onClick:_?void 0:S},t.children)}),yr=s.forwardRef((t,n)=>{let{heading:r,children:l,forceMount:a,...i}=t,c=q(),u=s.useRef(null),v=s.useRef(null),m=q(),g=he(),j=L(E=>a||g.filter()===!1?!0:E.search?E.filtered.groups.has(c):!0);H(()=>g.group(c),[]),ht(c,u,[t.value,t.heading,v]);let b=s.useMemo(()=>({id:c,forceMount:a}),[a]);return s.createElement(M.div,{ref:xe(u,n),...i,"cmdk-group":"",role:"presentation",hidden:j?void 0:!0},r&&s.createElement("div",{ref:v,"cmdk-group-heading":"","aria-hidden":!0,id:m},r),Ce(t,E=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?m:void 0},s.createElement(pt.Provider,{value:b},E))))}),br=s.forwardRef((t,n)=>{let{alwaysRender:r,...l}=t,a=s.useRef(null),i=L(c=>!c.search);return!r&&!i?null:s.createElement(M.div,{ref:xe(a,n),...l,"cmdk-separator":"",role:"separator"})}),Nr=s.forwardRef((t,n)=>{let{onValueChange:r,...l}=t,a=t.value!=null,i=Ue(),c=L(m=>m.search),u=L(m=>m.selectedItemId),v=he();return s.useEffect(()=>{t.value!=null&&i.setState("search",t.value)},[t.value]),s.createElement(M.input,{ref:n,...l,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":v.listId,"aria-labelledby":v.labelId,"aria-activedescendant":u,id:v.inputId,type:"text",value:a?t.value:c,onChange:m=>{a||i.setState("search",m.target.value),r==null||r(m.target.value)}})}),wr=s.forwardRef((t,n)=>{let{children:r,label:l="Suggestions",...a}=t,i=s.useRef(null),c=s.useRef(null),u=L(m=>m.selectedItemId),v=he();return s.useEffect(()=>{if(c.current&&i.current){let m=c.current,g=i.current,j,b=new ResizeObserver(()=>{j=requestAnimationFrame(()=>{let E=m.offsetHeight;g.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return b.observe(m),()=>{cancelAnimationFrame(j),b.unobserve(m)}}},[]),s.createElement(M.div,{ref:xe(i,n),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":u,"aria-label":l,id:v.listId},Ce(t,m=>s.createElement("div",{ref:xe(c,v.listInnerRef),"cmdk-list-sizer":""},m)))}),Cr=s.forwardRef((t,n)=>{let{open:r,onOpenChange:l,overlayClassName:a,contentClassName:i,container:c,...u}=t;return s.createElement($t,{open:r,onOpenChange:l},s.createElement(Tt,{container:c},s.createElement(Lt,{"cmdk-overlay":"",className:a}),s.createElement(Vt,{"aria-label":t.label,"cmdk-dialog":"",className:i},s.createElement(ft,{ref:n,...u}))))}),Er=s.forwardRef((t,n)=>L(r=>r.filtered.count===0)?s.createElement(M.div,{ref:n,...t,"cmdk-empty":"",role:"presentation"}):null),Sr=s.forwardRef((t,n)=>{let{progress:r,children:l,label:a="Loading...",...i}=t;return s.createElement(M.div,{ref:n,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Ce(t,c=>s.createElement("div",{"aria-hidden":!0},c)))}),D=Object.assign(ft,{List:wr,Item:jr,Input:Nr,Group:yr,Separator:br,Dialog:Cr,Empty:Er,Loading:Sr});function Rr(t,n){let r=t.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function Fr(t,n){let r=t.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function xt(t){let n=s.useRef(t);return H(()=>{n.current=t}),n}var H=typeof window>"u"?s.useEffect:s.useLayoutEffect;function W(t){let n=s.useRef();return n.current===void 0&&(n.current=t()),n}function L(t){let n=Ue(),r=()=>t(n.snapshot());return s.useSyncExternalStore(n.subscribe,r,r)}function ht(t,n,r,l=[]){let a=s.useRef(),i=he();return H(()=>{var c;let u=(()=>{var m;for(let g of r){if(typeof g=="string")return g.trim();if(typeof g=="object"&&"current"in g)return g.current?(m=g.current.textContent)==null?void 0:m.trim():a.current}})(),v=l.map(m=>m.trim());i.value(t,u,v),(c=n.current)==null||c.setAttribute(B,u),a.current=u}),a}var Ir=()=>{let[t,n]=s.useState(),r=W(()=>new Map);return H(()=>{r.current.forEach(l=>l()),r.current=new Map},[t]),(l,a)=>{r.current.set(l,a),n({})}};function Pr(t){let n=t.type;return typeof n=="function"?n(t.props):"render"in n?n.render(t.props):t}function Ce({asChild:t,children:n},r){return t&&s.isValidElement(n)?s.cloneElement(Pr(n),{ref:n.ref},r(n.props.children)):r(n)}var Ar={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const _e=s.forwardRef(({className:t,...n},r)=>e.jsx(D,{ref:r,className:I("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...n}));_e.displayName=D.displayName;const $e=s.forwardRef(({className:t,...n},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Wt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(D.Input,{ref:r,className:I("flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...n})]}));$e.displayName=D.Input.displayName;const Te=s.forwardRef(({className:t,...n},r)=>e.jsx(D.List,{ref:r,className:I("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...n}));Te.displayName=D.List.displayName;const Le=s.forwardRef((t,n)=>e.jsx(D.Empty,{ref:n,className:"py-6 text-center text-sm",...t}));Le.displayName=D.Empty.displayName;const Ve=s.forwardRef(({className:t,...n},r)=>e.jsx(D.Group,{ref:r,className:I("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n}));Ve.displayName=D.Group.displayName;const kr=s.forwardRef(({className:t,...n},r)=>e.jsx(D.Separator,{ref:r,className:I("-mx-1 h-px bg-border",t),...n}));kr.displayName=D.Separator.displayName;const Ke=s.forwardRef(({className:t,...n},r)=>e.jsx(D.Item,{ref:r,className:I("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...n}));Ke.displayName=D.Item.displayName;const Dr=Pt,vt=s.createContext({}),ue=({...t})=>e.jsx(vt.Provider,{value:{name:t.name},children:e.jsx(At,{...t})}),Ee=()=>{const t=s.useContext(vt),n=s.useContext(gt),{getFieldState:r,formState:l}=kt(),a=r(t.name,l);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:i}=n;return{id:i,name:t.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},gt=s.createContext({}),J=s.forwardRef(({className:t,...n},r)=>{const l=s.useId();return e.jsx(gt.Provider,{value:{id:l},children:e.jsx("div",{ref:r,className:I("space-y-2",t),...n})})});J.displayName="FormItem";const X=s.forwardRef(({className:t,...n},r)=>{const{error:l,formItemId:a}=Ee();return e.jsx(Jt,{ref:r,className:I(l&&"text-destructive",t),htmlFor:a,...n})});X.displayName="FormLabel";const Z=s.forwardRef(({...t},n)=>{const{error:r,formItemId:l,formDescriptionId:a,formMessageId:i}=Ee();return e.jsx(nt,{ref:n,id:l,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...t})});Z.displayName="FormControl";const Or=s.forwardRef(({className:t,...n},r)=>{const{formDescriptionId:l}=Ee();return e.jsx("p",{ref:r,id:l,className:I("text-[0.8rem] text-muted-foreground",t),...n})});Or.displayName="FormDescription";const Q=s.forwardRef(({className:t,children:n,...r},l)=>{const{error:a,formMessageId:i}=Ee(),c=a?String(a==null?void 0:a.message):n;return c?e.jsx("p",{ref:l,id:i,className:I("text-[0.8rem] font-medium text-destructive",t),...r,children:c}):null});Q.displayName="FormMessage";var qe="Popover",[jt,mn]=zt(qe,[ot]),ve=ot(),[Mr,V]=jt(qe),yt=t=>{const{__scopePopover:n,children:r,open:l,defaultOpen:a,onOpenChange:i,modal:c=!1}=t,u=ve(n),v=s.useRef(null),[m,g]=s.useState(!1),[j=!1,b]=Kt({prop:l,defaultProp:a,onChange:i});return e.jsx(Xt,{...u,children:e.jsx(Mr,{scope:n,contentId:q(),triggerRef:v,open:j,onOpenChange:b,onOpenToggle:s.useCallback(()=>b(E=>!E),[b]),hasCustomAnchor:m,onCustomAnchorAdd:s.useCallback(()=>g(!0),[]),onCustomAnchorRemove:s.useCallback(()=>g(!1),[]),modal:c,children:r})})};yt.displayName=qe;var bt="PopoverAnchor",_r=s.forwardRef((t,n)=>{const{__scopePopover:r,...l}=t,a=V(bt,r),i=ve(r),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=a;return s.useEffect(()=>(c(),()=>u()),[c,u]),e.jsx(lt,{...i,...l,ref:n})});_r.displayName=bt;var Nt="PopoverTrigger",wt=s.forwardRef((t,n)=>{const{__scopePopover:r,...l}=t,a=V(Nt,r),i=ve(r),c=st(n,a.triggerRef),u=e.jsx(M.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ft(a.open),...l,ref:c,onClick:pe(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?u:e.jsx(lt,{asChild:!0,...i,children:u})});wt.displayName=Nt;var He="PopoverPortal",[$r,Tr]=jt(He,{forceMount:void 0}),Ct=t=>{const{__scopePopover:n,forceMount:r,children:l,container:a}=t,i=V(He,n);return e.jsx($r,{scope:n,forceMount:r,children:e.jsx(at,{present:r||i.open,children:e.jsx(Ut,{asChild:!0,container:a,children:l})})})};Ct.displayName=He;var ee="PopoverContent",Et=s.forwardRef((t,n)=>{const r=Tr(ee,t.__scopePopover),{forceMount:l=r.forceMount,...a}=t,i=V(ee,t.__scopePopover);return e.jsx(at,{present:l||i.open,children:i.modal?e.jsx(Lr,{...a,ref:n}):e.jsx(Vr,{...a,ref:n})})});Et.displayName=ee;var Lr=s.forwardRef((t,n)=>{const r=V(ee,t.__scopePopover),l=s.useRef(null),a=st(n,l),i=s.useRef(!1);return s.useEffect(()=>{const c=l.current;if(c)return qt(c)},[]),e.jsx(Ht,{as:nt,allowPinchZoom:!0,children:e.jsx(St,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:pe(t.onCloseAutoFocus,c=>{var u;c.preventDefault(),i.current||(u=r.triggerRef.current)==null||u.focus()}),onPointerDownOutside:pe(t.onPointerDownOutside,c=>{const u=c.detail.originalEvent,v=u.button===0&&u.ctrlKey===!0,m=u.button===2||v;i.current=m},{checkForDefaultPrevented:!1}),onFocusOutside:pe(t.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),Vr=s.forwardRef((t,n)=>{const r=V(ee,t.__scopePopover),l=s.useRef(!1),a=s.useRef(!1);return e.jsx(St,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,u;(c=t.onCloseAutoFocus)==null||c.call(t,i),i.defaultPrevented||(l.current||(u=r.triggerRef.current)==null||u.focus(),i.preventDefault()),l.current=!1,a.current=!1},onInteractOutside:i=>{var v,m;(v=t.onInteractOutside)==null||v.call(t,i),i.defaultPrevented||(l.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=i.target;((m=r.triggerRef.current)==null?void 0:m.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),St=s.forwardRef((t,n)=>{const{__scopePopover:r,trapFocus:l,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:v,onFocusOutside:m,onInteractOutside:g,...j}=t,b=V(ee,r),E=ve(r);return Yt(),e.jsx(Gt,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Bt,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:g,onEscapeKeyDown:u,onPointerDownOutside:v,onFocusOutside:m,onDismiss:()=>b.onOpenChange(!1),children:e.jsx(Zt,{"data-state":Ft(b.open),role:"dialog",id:b.contentId,...E,...j,ref:n,style:{...j.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Rt="PopoverClose",Kr=s.forwardRef((t,n)=>{const{__scopePopover:r,...l}=t,a=V(Rt,r);return e.jsx(M.button,{type:"button",...l,ref:n,onClick:pe(t.onClick,()=>a.onOpenChange(!1))})});Kr.displayName=Rt;var zr="PopoverArrow",Ur=s.forwardRef((t,n)=>{const{__scopePopover:r,...l}=t,a=ve(r);return e.jsx(Qt,{...a,...l,ref:n})});Ur.displayName=zr;function Ft(t){return t?"open":"closed"}var qr=yt,Hr=wt,Yr=Ct,It=Et;const Ne=qr,we=Hr,me=s.forwardRef(({className:t,align:n="center",sideOffset:r=4,...l},a)=>e.jsx(Yr,{children:e.jsx(It,{ref:a,align:n,sideOffset:r,className:I("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})}));me.displayName=It.displayName;const De=[{value:"manpower",label:"Manpower"},{value:"food",label:"Food"},{value:"fair",label:"Fair"},{value:"fuel",label:"Fuel"},{value:"staffAdvance",label:"Staff Advance"},{value:"miscellaneous",label:"Miscellaneous"}];function Gr(){var G;const[t,n]=s.useState(null),[r,l]=s.useState(!1),[a,i]=s.useState(!1),[c,u]=s.useState([]),[v,m]=s.useState([]),[g,j]=s.useState([]),[b,E]=s.useState(""),[S,Y]=s.useState({from:null,to:null}),[_,K]=s.useState(!1);s.useEffect(()=>{(async()=>{l(!0);try{const x=(await er.getUserOrders()).orders.map(k=>({...k,products:typeof k.products=="string"?JSON.parse(k.products):k.products}));u(x||[]);const R=await Se.get("https://imsuser.infinimorphconsulting.com/api/expenses");m(R.data.data||[]),j(R.data.data||[])}catch(h){console.error("Error fetching data:",h),se.error("Failed to fetch data. Please try again later.")}finally{l(!1)}})()},[]),s.useEffect(()=>{let d=v;b&&(d=d.filter(h=>h.order_id.toString()===b)),S.from&&S.to&&(d=d.filter(h=>lr(Je(h.expense_date),{start:S.from,end:S.to}))),j(d)},[b,S,v]);const F=Dt({defaultValues:{orderId:"",expenses:De.map(d=>({type:d.value,amount:void 0})),otherExpenses:[],expenseDate:new Date},mode:"onSubmit"}),{fields:ge,append:te}=Ot({control:F.control,name:"otherExpenses"}),$=d=>d.expenses.some(x=>x.amount>0)||d.otherExpenses&&d.otherExpenses.some(x=>x.amount>0)?!0:(F.setError("expenses",{type:"manual",message:"At least one expense amount must be added."}),!1),C=d=>{l(!0);const h=c.find(x=>x.id.toString()===d);if(h&&h.delivered_date){const x=new Date(h.delivered_date);if(Math.abs(or(x,new Date))>7){se.error("Selected order's delivery date must be within 7 days from today."),n(null),F.setValue("orderId",""),l(!1);return}}else{se.error("Selected order has no valid delivery date."),n(null),F.setValue("orderId",""),l(!1);return}setTimeout(()=>{n(h||null),l(!1)},500)},P=async d=>{var x,R;if(!$(d))return;const h="https://imsuser.infinimorphconsulting.com/api/expenses";l(!0);try{const ne=[...d.expenses.filter(T=>T.amount&&T.amount>0),...d.otherExpenses||[]],z=await Se.post(h,{order_id:d.orderId,expenses:ne,expense_date:de(d.expenseDate,"yyyy-MM-dd")});if(z.status===201){se.success(`${z.data.data.expense_count} expense(s) added to order ${z.data.data.order_id}`),F.reset({orderId:"",expenses:De.map(ye=>({type:ye.value,amount:void 0})),otherExpenses:[],expenseDate:new Date}),n(null);const T=await Se.get(h);m(T.data.data||[]),j(T.data.data||[])}}catch(k){se.error(((R=(x=k.response)==null?void 0:x.data)==null?void 0:R.message)||"Failed to submit expenses")}finally{l(!1)}},re=d=>d.reduce((h,x)=>h+parseFloat(x.amount||0),0).toFixed(2),je=()=>{E(""),Y({from:null,to:null}),j(v)};return e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[e.jsx(Mt,{}),e.jsxs(ae,{className:"mb-8",children:[e.jsxs(oe,{children:[e.jsx(le,{className:"text-2xl",children:"Add Expense"}),e.jsx(Fe,{children:"Add a new expense related to an order (within 7 days of delivery)"})]}),e.jsx(ie,{children:e.jsx(Dr,{...F,children:e.jsxs("form",{onSubmit:F.handleSubmit(P),className:"space-y-6",children:[e.jsx(ue,{control:F.control,name:"orderId",render:({field:d})=>{var h;return e.jsxs(J,{className:"flex flex-col",children:[e.jsx(X,{children:"Order ID"}),e.jsxs(Ne,{open:a,onOpenChange:i,children:[e.jsx(we,{asChild:!0,children:e.jsx(Z,{children:e.jsxs(U,{variant:"outline",role:"combobox",className:I("w-full justify-between",!d.value&&"text-muted-foreground"),children:[d.value?`ARYAN00${(h=c.find(x=>x.id.toString()===d.value))==null?void 0:h.id}`:"Select order ID",e.jsx(Ze,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),e.jsx(me,{className:"w-full p-0",children:e.jsxs(_e,{children:[e.jsx($e,{placeholder:"Search order ID..."}),e.jsxs(Te,{children:[e.jsx(Le,{children:"No order found."}),e.jsx(Ve,{children:c.map(x=>e.jsxs(Ke,{value:x.id.toString(),onSelect:R=>{F.setValue("orderId",R),C(R),i(!1)},children:[e.jsx(We,{className:I("mr-2 h-4 w-4",x.id.toString()===d.value?"opacity-100":"opacity-0")}),"ARYAN00",x.id]},x.id))})]})]})})]}),e.jsx(Q,{})]})}}),r&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Ie,{className:"h-6 w-6 animate-spin text-primary"})}),t&&!r&&e.jsxs(ae,{className:"bg-muted/40",children:[e.jsx(oe,{className:"pb-2",children:e.jsx(le,{className:"text-lg",children:"Order Details"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Customer Name"}),e.jsx("p",{className:"text-sm",children:t.user_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Order Total"}),e.jsxs("p",{className:"text-sm",children:["₹",parseFloat(t.total_amount).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Delivered Date"}),e.jsx("p",{className:"text-sm",children:t.delivered_date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Products"}),e.jsx("p",{className:"text-sm",children:t.products.map(d=>d.product_name||"Unknown").join(", ")})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium mb-2",children:"Expense Types"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:De.map((d,h)=>e.jsx(ue,{control:F.control,name:`expenses.${h}.amount`,render:({field:x})=>e.jsxs(J,{children:[e.jsx(X,{children:d.label}),e.jsx(Z,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"₹"}),e.jsx(Re,{type:"number",step:"0.01",placeholder:"0.00",className:"pl-8",...x,value:x.value||"",onChange:R=>x.onChange(R.target.valueAsNumber)})]})}),e.jsx(Q,{})]})},d.value))})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-base font-medium mb-2",children:"Other Expenses"}),ge.map((d,h)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx(ue,{control:F.control,name:`otherExpenses.${h}.type`,render:({field:x})=>e.jsxs(J,{children:[e.jsx(X,{children:"Type"}),e.jsx(Z,{children:e.jsx(Re,{placeholder:"Enter expense type",...x})}),e.jsx(Q,{})]})}),e.jsx(ue,{control:F.control,name:`otherExpenses.${h}.amount`,render:({field:x})=>e.jsxs(J,{children:[e.jsx(X,{children:"Amount"}),e.jsx(Z,{children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"₹"}),e.jsx(Re,{type:"number",step:"0.01",placeholder:"0.00",className:"pl-8",...x,value:x.value||"",onChange:R=>x.onChange(R.target.valueAsNumber)})]})}),e.jsx(Q,{})]})})]},d.id)),e.jsxs(U,{type:"button",variant:"outline",size:"sm",onClick:()=>te({type:"",amount:void 0}),children:[e.jsx(ar,{className:"mr-2 h-4 w-4"}),"Add Other Expense"]})]})]}),e.jsx(ue,{control:F.control,name:"expenseDate",render:({field:d})=>e.jsxs(J,{className:"flex flex-col",children:[e.jsx(X,{children:"Date of Expense"}),e.jsxs(Ne,{children:[e.jsx(we,{asChild:!0,children:e.jsx(Z,{children:e.jsxs(U,{variant:"outline",className:I("w-full pl-3 text-left font-normal",!d.value&&"text-muted-foreground"),children:[d.value?de(d.value,"yyyy-MM-dd"):e.jsx("span",{children:"Pick a date"}),e.jsx(Xe,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(me,{className:"w-auto p-0",align:"start",children:e.jsx(Be,{mode:"single",selected:d.value,onSelect:d.onChange,initialFocus:!0})})]}),e.jsx(Q,{})]})}),e.jsx(U,{type:"submit",className:"w-full",disabled:r||!t,children:r?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Add Expense"})]})})})]}),e.jsxs(ae,{className:"mb-8",children:[e.jsxs(oe,{children:[e.jsx(le,{className:"text-2xl",children:"Filter Expenses"}),e.jsx(Fe,{children:"Filter expenses by order ID or date range"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Filter by Order ID"}),e.jsxs(Ne,{open:_,onOpenChange:K,children:[e.jsx(we,{asChild:!0,children:e.jsxs(U,{variant:"outline",role:"combobox",className:I("w-full justify-between",!b&&"text-muted-foreground"),children:[b?`ARYAN00${(G=c.find(d=>d.id.toString()===b))==null?void 0:G.id}`:"Select order ID",e.jsx(Ze,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(me,{className:"w-full p-0",children:e.jsxs(_e,{children:[e.jsx($e,{placeholder:"Search order ID..."}),e.jsxs(Te,{children:[e.jsx(Le,{children:"No order found."}),e.jsx(Ve,{children:c.map(d=>e.jsxs(Ke,{value:d.id.toString(),onSelect:h=>{E(h),K(!1)},children:[e.jsx(We,{className:I("mr-2 h-4 w-4",d.id.toString()===b?"opacity-100":"opacity-0")}),"ARYAN00",d.id]},d.id))})]})]})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Filter by Date Range"}),e.jsxs(Ne,{children:[e.jsx(we,{asChild:!0,children:e.jsxs(U,{variant:"outline",className:I("w-full justify-start text-left font-normal",!S.from&&!S.to&&"text-muted-foreground"),children:[e.jsx(Xe,{className:"mr-2 h-4 w-4"}),S.from&&S.to?`${de(S.from,"yyyy-MM-dd")} - ${de(S.to,"yyyy-MM-dd")}`:"Select date range"]})}),e.jsx(me,{className:"w-auto p-0",children:e.jsx(Be,{mode:"range",selected:S,onSelect:d=>Y({from:d==null?void 0:d.from,to:d==null?void 0:d.to}),initialFocus:!0})})]})]}),e.jsx(U,{variant:"outline",onClick:je,children:"Reset Filters"})]})})]}),e.jsxs(ae,{children:[e.jsxs(oe,{children:[e.jsx(le,{className:"text-2xl",children:"All Expenses"}),e.jsx(Fe,{children:"View all recorded expenses with order details"})]}),e.jsx(ie,{children:r?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Ie,{className:"h-6 w-6 animate-spin text-primary"})}):g.length===0?e.jsx("p",{className:"text-center text-muted-foreground",children:"No expenses match the current filters."}):e.jsx("div",{className:"space-y-4",children:g.map(d=>e.jsxs(ae,{className:"bg-muted/40",children:[e.jsx(oe,{className:"pb-2",children:e.jsxs(le,{className:"text-lg",children:["Order ARYAN",d.order_id," - ",de(Je(d.expense_date),"yyyy-MM-dd")]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.order_details&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Customer Name"}),e.jsx("p",{className:"text-sm",children:d.order_details.customer_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Order Total"}),e.jsxs("p",{className:"text-sm",children:["₹",parseFloat(d.order_details.total_amount).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Delivered Date"}),e.jsx("p",{className:"text-sm",children:d.order_details.delivered_date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Status"}),e.jsx("p",{className:"text-sm",children:d.order_details.status})]})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"Expenses:"}),e.jsx("ul",{className:"list-disc pl-5 text-sm",children:d.expenses.map((h,x)=>e.jsxs("li",{children:[h.type,": ₹",parseFloat(h.amount).toFixed(2)]},x))}),e.jsxs("p",{className:"text-sm font-medium mt-2",children:["Total Expenses: ₹",re(d.expenses)]})]})]})]},d.id))})})]})]})}function pn(){return e.jsx(tr,{children:e.jsx(Gr,{})})}export{pn as default};
