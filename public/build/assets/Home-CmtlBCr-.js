import{j as e,r as u,a as ee}from"./app-DBEXB0bx.js";import{S as I,a as R,b as B,c as M,d as p}from"./select-C9lpisMf.js";import{o as F}from"./orders-CNV1tS7Y.js";import{C,a as D,d as A,e as S,b as T}from"./card-CiWm1my2.js";import{i as te,I as ae}from"./index-Bw473KWJ.js";import{U as z,W as se,D as j,T as le,R as K,A as ne,C as re,X as ie,Y as ce,a as de,b as W,P as oe,c as ge,d as xe,L as me}from"./Dashboard-Cb0HQFYA.js";import{C as ue}from"./circle-check-big-K6k2ohe8.js";import{C as he}from"./calendar-CwWCcPHl.js";import{L as pe}from"./Layout-Bo4FfiFU.js";import"./index-CH45Fil6.js";import"./input-D-S2Efej.js";import"./dialog-N9Og5fO0.js";import"./index-ueKhdn10.js";import"./index-Bvbvqvz9.js";import"./index-CfGfc-dP.js";const m=({title:t,value:r,description:a,icon:s,colorClass:l,bgClass:c})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:`${c} p-4 rounded-t-lg`,children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(s,{className:`w-6 h-6 sm:w-7 sm:h-7 ${l}`}),t]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm",children:a})]}),e.jsx(T,{className:"p-4",children:e.jsx("p",{className:`text-3xl sm:text-4xl font-bold ${l} flex items-center`,children:t.includes("Amount")||t.includes("Expenses")||t.includes("Revenue")?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:20,className:"mr-1"})," ",r.toFixed(2)]}):r})})]}),ye=({companyOrders:t,filteredOrders:r,successfulPayments:a,totalActualPayAmount:s,totalPaidAmount:l,totalPendingAmount:c,totalExpensesAmount:n,netRevenue:i})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(m,{title:"Total Orders",value:t.length,description:"All company orders",icon:te,colorClass:"text-indigo-600 dark:text-indigo-400",bgClass:"bg-indigo-50 dark:bg-indigo-900"}),e.jsx(m,{title:"My Orders",value:r.length,description:"Your personal orders",icon:z,colorClass:"text-teal-600 dark:text-teal-400",bgClass:"bg-teal-50 dark:bg-teal-900"}),e.jsx(m,{title:"Paid Orders",value:a.length,description:"Successful payments",icon:ue,colorClass:"text-green-600 dark:text-green-400",bgClass:"bg-green-50 dark:bg-green-900"}),e.jsx(m,{title:"Total Order Amount",value:s,description:"Total amount owed",icon:se,colorClass:"text-blue-600 dark:text-blue-400",bgClass:"bg-blue-50 dark:bg-blue-900"}),e.jsx(m,{title:"Total Paid Amount",value:l,description:"Total payments received",icon:j,colorClass:"text-purple-600 dark:text-purple-400",bgClass:"bg-purple-50 dark:bg-purple-900"}),e.jsx(m,{title:"Total Pending Amount",value:c,description:"Total amount pending",icon:j,colorClass:"text-orange-600 dark:text-orange-400",bgClass:"bg-orange-50 dark:bg-orange-900"}),e.jsx(m,{title:"Total Expenses",value:n,description:"All recorded expenses",icon:j,colorClass:"text-red-600 dark:text-red-400",bgClass:"bg-red-50 dark:bg-red-900"}),e.jsx(m,{title:"Net Revenue",value:i,description:"Revenue after expenses",icon:j,colorClass:"text-yellow-600 dark:text-yellow-400",bgClass:"bg-yellow-50 dark:bg-yellow-900"})]}),k=({title:t,data:r,timeRange:a,color:s,gradientId:l,bgClass:c,iconColor:n})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:`${c} p-4 rounded-t-lg`,children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(le,{className:`w-6 h-6 sm:w-7 sm:h-7 ${n}`}),t]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm",children:a==="All"?"All time":`Last ${a} days`})]}),e.jsx(T,{className:"p-4 sm:p-6",children:e.jsx(K,{width:"100%",height:300,children:r.length>0?e.jsxs(ne,{data:r,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:l,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:s,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),e.jsx(re,{strokeDasharray:"3 3",stroke:"#e0e0e0",opacity:.5}),e.jsx(ie,{dataKey:"date",stroke:"#666",tick:{fill:"#666",fontSize:12},tickFormatter:i=>a==="All"?i:i.split("-").slice(1).join("-")}),e.jsx(ce,{stroke:"#666",tick:{fill:"#666",fontSize:12}}),e.jsx(de,{type:"monotone",dataKey:"orders",stroke:s,strokeWidth:2,fill:`url(#${l})`,dot:{r:4,fill:s}}),e.jsx(W,{contentStyle:{backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e0e0e0"},labelStyle:{color:"#333"},itemStyle:{color:s},labelFormatter:i=>`Date: ${i}`,formatter:i=>Math.round(i)})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 text-sm",children:"No data available for this range"})})})]}),v=["#6b7280","#f97316","#22c55e","#3b82f6","#a855f7"],be=({top5Users:t,filteredOrders:r,timeRange:a})=>e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 col-span-1 lg:col-span-2",children:[e.jsxs(D,{className:"bg-indigo-50 dark:bg-indigo-900 p-4 rounded-t-lg flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(z,{className:"w-6 h-6 sm:w-7 sm:h-7 text-indigo-600 dark:text-indigo-400"}),"Order Distribution (Top 5 Users)"]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:a==="All"?"All time":`Last ${a} days`})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0 bg-indigo-100 dark:bg-indigo-800 px-3 py-1 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total Orders:"}),e.jsx("span",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:r.length})]})]}),e.jsx(T,{className:"p-4 sm:p-6",children:e.jsx(K,{width:"100%",height:300,children:t.length>0?e.jsxs(oe,{children:[e.jsx(ge,{data:t,dataKey:"value",nameKey:"name",innerRadius:"50%",outerRadius:"80%",paddingAngle:5,animationDuration:800,animationBegin:100,labelLine:!1,label:({name:s,value:l})=>`${s}: ${l}`,children:t.map((s,l)=>e.jsx(xe,{fill:v[l%v.length]},`cell-${l}`))}),e.jsx(W,{contentStyle:{backgroundColor:"#fff",borderRadius:"6px",border:"1px solid #e0e0e0"},labelStyle:{color:"#333"},formatter:(s,l)=>[`${s} orders`,l]}),e.jsx(me,{layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{paddingLeft:"20px",fontSize:"14px",color:"#333"},formatter:(s,l)=>e.jsxs("span",{style:{color:v[l.payload.payload.fill?v.indexOf(l.payload.payload.fill):0]},children:[s,": ",l.payload.value]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400 text-sm",children:"No user data available"})})})]}),fe=({orders:t})=>{var c;const[r,a]=u.useState("all"),s=((c=t==null?void 0:t.filter(n=>{if(!(n!=null&&n.delivered_date))return!1;const i=new Date(n==null?void 0:n.delivered_date),o=new Date;return!isNaN(i==null?void 0:i.getTime())&&i>o}))==null?void 0:c.sort((n,i)=>new Date(n==null?void 0:n.delivered_date)-new Date(i==null?void 0:i.delivered_date)))||[],l=(s==null?void 0:s.filter(n=>{const b=(new Date(n==null?void 0:n.delivered_date)-new Date)/(1e3*3600*24);return r==="week"?b<=7:r==="month"?b<=30:!0}))||[];return e.jsxs(C,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsxs(D,{className:"bg-purple-50 dark:bg-purple-900 p-4 rounded-t-lg flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2 text-gray-800 dark:text-gray-100 text-lg sm:text-xl font-semibold",children:[e.jsx(he,{className:"w-6 h-6 sm:w-7 sm:h-7 text-purple-600 dark:text-purple-400"}),"Upcoming Deliveries"]}),e.jsx(S,{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Orders scheduled for delivery"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 sm:mt-0",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Filter:"}),e.jsxs(I,{value:r,onValueChange:a,children:[e.jsx(R,{className:"w-[120px] rounded-lg border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100",children:e.jsx(B,{placeholder:"All"})}),e.jsxs(M,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:[e.jsx(p,{value:"all",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"All Upcoming"}),e.jsx(p,{value:"week",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Next 7 Days"}),e.jsx(p,{value:"month",className:"text-gray-800 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Next 30 Days"})]})]})]})]}),e.jsx(T,{className:"p-4 sm:p-6",children:(l==null?void 0:l.length)>0?e.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto",children:l==null?void 0:l.map(n=>e.jsxs("div",{className:"flex justify-between items-center border-b pb-2 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100",children:["Order #",n==null?void 0:n.id," - ",(n==null?void 0:n.user_name)||"Unknown"]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Status: ",(n==null?void 0:n.status)||"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:[(n==null?void 0:n.delivered_date)||"Date TBD"," "]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[n!=null&&n.delivered_date?Math.ceil((new Date(n==null?void 0:n.delivered_date)-new Date)/(1e3*3600*24)):"N/A"," days"]})]})]},n==null?void 0:n.id))}):e.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500 dark:text-gray-400 text-sm",children:"No upcoming deliveries found"})})]})},je=t=>{const r=[];for(let a=t-1;a>=0;a--){const s=new Date;s.setDate(s.getDate()-a),r.push(s.toISOString().split("T")[0])}return r},N=(t,r)=>{const a={};return r.forEach(s=>{a[s]=0}),t==null||t.forEach(s=>{const l=new Date(s==null?void 0:s.created_at).toISOString().split("T")[0];a[l]!==void 0&&a[l]++}),r.map(s=>({date:s,orders:a[s]||0}))},ke=(t,r)=>{const a=new Date;return(t==null?void 0:t.filter(s=>{const l=new Date(s==null?void 0:s.created_at);return r==="All"?!0:(a-l)/(1e3*3600*24)<=r}))||[]},ve=t=>{const r=(t==null?void 0:t.reduce((a,s)=>{const l=(s==null?void 0:s.user_id)||"unknown";return a[l]=(a[l]||0)+1,a},{}))||{};return Object.entries(r).sort(([,a],[,s])=>s-a).slice(0,5).map(([a,s])=>({name:a==="unknown"?"Unknown User":`User ${a}`,value:s}))},Ne=(t,r)=>{var s;const a=new Set(r==null?void 0:r.map(l=>{var c;return(c=l==null?void 0:l.id)==null?void 0:c.toString()}));return((s=t==null?void 0:t.filter(l=>a.has(l==null?void 0:l.order_id)))==null?void 0:s.reduce((l,c)=>{var n;return l+(((n=c==null?void 0:c.expenses)==null?void 0:n.reduce((i,o)=>i+parseFloat((o==null?void 0:o.amount)||0),0))||0)},0))||0},we=t=>(t==null?void 0:t.reduce((r,a)=>r+parseFloat((a==null?void 0:a.total_amount)||0),0))||0,Ce=t=>(t==null?void 0:t.reduce((r,a)=>r+parseFloat((a==null?void 0:a.paid_payment)||0),0))||0,De=t=>(t==null?void 0:t.reduce((r,a)=>r+parseFloat((a==null?void 0:a.pending_payment)||0),0))||0,w=t=>{if(!(t!=null&&t.length))return[];const r={};return t.forEach(a=>{const l=new Date(a==null?void 0:a.created_at).toLocaleString("default",{month:"short",year:"numeric"});r[l]=(r[l]||0)+1}),Object.keys(r).map(a=>({date:a,orders:r[a]}))},Ae=()=>{const[t,r]=u.useState([]),[a,s]=u.useState([]),[l,c]=u.useState([]),[n,i]=u.useState(null),[o,b]=u.useState(!0),[g,V]=u.useState("All");if(u.useEffect(()=>{(async()=>{var U;try{const[y,O,_]=await Promise.all([F.getAllOrders(),F.getUserOrders(),ee.get("api/expenses")]);r((y==null?void 0:y.orders)||[]),s((O==null?void 0:O.orders)||[]),c(((U=_==null?void 0:_.data)==null?void 0:U.data)||[])}catch(y){i("Failed to fetch data. Please try again later."),console.error("Error fetching data:",y)}finally{b(!1)}})()},[]),o)return e.jsx("div",{className:"p-6 text-center",children:"Loading Dashboard..."});if(n)return e.jsx("div",{className:"p-6 text-center text-red-600",children:n});const h=g==="All"?"All":parseInt(g),f=h==="All"?[]:je(h),d=ke(a,h),Y=ve(d),L=Ne(l,d),G=we(d),$=Ce(d),X=De(d),H=$-L,P=(d==null?void 0:d.filter(x=>(x==null?void 0:x.status)==="paid"))||[],E=(d==null?void 0:d.filter(x=>(x==null?void 0:x.status)==="pending"))||[],q=h==="All"?w(t):N(t,f),J=h==="All"?w(d):N(d,f),Q=h==="All"?w(P):N(P,f),Z=h==="All"?w(E):N(E,f);return e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 lg:p-10 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"mb-6 sm:mb-8 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 dark:text-gray-100 tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Time Range:"}),e.jsxs(I,{value:g,onValueChange:V,children:[e.jsx(R,{className:"w-[140px] sm:w-[150px]",children:e.jsx(B,{placeholder:"All Time"})}),e.jsxs(M,{children:[e.jsx(p,{value:"7",children:"Last 7 Days"}),e.jsx(p,{value:"30",children:"Last 30 Days"}),e.jsx(p,{value:"All",children:"All Time"})]})]})]})]}),e.jsx(ye,{companyOrders:t,filteredOrders:d,successfulPayments:P,totalActualPayAmount:G,totalPaidAmount:$,totalPendingAmount:X,totalExpensesAmount:L,netRevenue:H}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(k,{title:"Company Orders Trend",data:q,timeRange:g,color:"#0070f3",gradientId:"colorOrders",bgClass:"bg-indigo-50 dark:bg-indigo-900",iconColor:"text-indigo-600 dark:text-indigo-400"}),e.jsx(k,{title:"My Orders Trend",data:J,timeRange:g,color:"#00b894",gradientId:"colorMyOrders",bgClass:"bg-teal-50 dark:bg-teal-900",iconColor:"text-teal-600 dark:text-teal-400"}),e.jsx(k,{title:"Successful Payments Trend",data:Q,timeRange:g,color:"#2ecc71",gradientId:"colorSuccess",bgClass:"bg-green-50 dark:bg-green-900",iconColor:"text-green-600 dark:text-green-400"}),e.jsx(k,{title:"Pending Payments Trend",data:Z,timeRange:g,color:"#f39c12",gradientId:"colorPending",bgClass:"bg-orange-50 dark:bg-orange-900",iconColor:"text-orange-600 dark:text-orange-400"}),e.jsx(be,{top5Users:Y,filteredOrders:d,timeRange:g}),e.jsx(fe,{orders:a})]})]})};function Ke(){return console.log("API URL:","https://ims.nikatby.in/user/public"),e.jsx(pe,{children:e.jsx(Ae,{})})}export{Ke as default};
